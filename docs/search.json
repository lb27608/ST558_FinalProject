[
  {
    "objectID": "EDA.html",
    "href": "EDA.html",
    "title": "ST 558 Final Project: Exploratory Data Analysis",
    "section": "",
    "text": "The purpose of this analysis is to create a predictive model for the incidence of diabetes using data from the 2015 Behavioral Risk Factor Surveillance System (BRFSS) survey conducted by the Centers for Disease Control. The dataset we will use for modeling includes survey responses from 253,680 individuals.\nThe response variable in the dataset, Diabetes_binary, is a 0/1 indicator for the presence of diabetes or prediabetes. There are a number of potential predictors in the dataset, but we will consider only the following health-related variables in the dataset:\n\nBinary factors for hypertension and high cholesterol (yes vs. no)\nReported body mass index (BMI)\nSex (male vs. female)\nSmoking history (at least 100 packs in a lifetime vs. less or none)\nA factor for having any kind of health insurance coverage (yes vs. no)\nAn ordinal factor for self-rated general health, ranging from 1 (“Excellent”) to 5 (“Poor”)"
  },
  {
    "objectID": "EDA.html#introduction",
    "href": "EDA.html#introduction",
    "title": "ST 558 Final Project: Exploratory Data Analysis",
    "section": "",
    "text": "The purpose of this analysis is to create a predictive model for the incidence of diabetes using data from the 2015 Behavioral Risk Factor Surveillance System (BRFSS) survey conducted by the Centers for Disease Control. The dataset we will use for modeling includes survey responses from 253,680 individuals.\nThe response variable in the dataset, Diabetes_binary, is a 0/1 indicator for the presence of diabetes or prediabetes. There are a number of potential predictors in the dataset, but we will consider only the following health-related variables in the dataset:\n\nBinary factors for hypertension and high cholesterol (yes vs. no)\nReported body mass index (BMI)\nSex (male vs. female)\nSmoking history (at least 100 packs in a lifetime vs. less or none)\nA factor for having any kind of health insurance coverage (yes vs. no)\nAn ordinal factor for self-rated general health, ranging from 1 (“Excellent”) to 5 (“Poor”)"
  },
  {
    "objectID": "EDA.html#analysis-data",
    "href": "EDA.html#analysis-data",
    "title": "ST 558 Final Project: Exploratory Data Analysis",
    "section": "Analysis Data",
    "text": "Analysis Data\nWe’ll first read in the raw data from the CSV file and then transform the predictors of interest into a form suitable for analysis:\n\n#Read in the raw data\ndiabetes_raw &lt;- read_csv(file=\"diabetes_binary_health_indicators_BRFSS2015.csv\",show_col_types=FALSE)\n\n#Create an analysis dataset containing only the relevant variables\nyn_label &lt;- c(\"No\",\"Yes\")\ndiabetes_ad &lt;- diabetes_raw |&gt; select(Diabetes_binary, HighBP ,HighChol, BMI, Smoker, Sex, AnyHealthcare, GenHlth) |&gt;\n  mutate(diabetes = factor(Diabetes_binary, levels=c(0,1), labels=c(\"No diabetes\", \"Diabetes or prediabetes\")),\n         high_bp = factor(HighBP, levels=c(0,1), labels=yn_label),\n         high_chol = factor(HighChol, levels=c(0,1), labels=yn_label),\n         sex = factor(Sex, levels=c(0,1), labels=c(\"Female\",\"Male\")),\n         smoker = factor(Smoker, levels=c(0,1), labels=c(\"Less than 100 packs or none\", \"At least 100 packs\")),\n         healthcare = factor(AnyHealthcare, levels=c(0,1), labels=yn_label),\n         gen_health = factor(GenHlth, levels=c(1,2,3,4,5), labels=c(\"Excellent\", \"Very good\", \"Good\", \"Fair\", \"Poor\")),\n         .keep=\"unused\")\n\n#Check for missing data\ncolSums(is.na(diabetes_ad))\n\n       BMI   diabetes    high_bp  high_chol        sex     smoker healthcare \n         0          0          0          0          0          0          0 \ngen_health \n         0 \n\n\nThere is no missingness among the variables that we’ve chosen, so we can move on to explore the relationships between the incidence of diabetes and the predictor variables we’ve chosen."
  },
  {
    "objectID": "EDA.html#exploratory-analysis",
    "href": "EDA.html#exploratory-analysis",
    "title": "ST 558 Final Project: Exploratory Data Analysis",
    "section": "Exploratory Analysis",
    "text": "Exploratory Analysis\nFor the first part of the exploratory data analysis, we’ll examine the predictor variables to find the most prevalent values for the categorical predictors and the summary statistics for the only continuous predictor we’ve chosen, BMI:\n\n#Number with prediabetes or diabetes\nprop.table(table(diabetes_ad$diabetes))\n\n\n            No diabetes Diabetes or prediabetes \n               0.860667                0.139333 \n\n#Categorical summaries for predictors\nprop.table(table(diabetes_ad$high_bp))\n\n\n       No       Yes \n0.5709989 0.4290011 \n\nprop.table(table(diabetes_ad$high_chol))\n\n\n       No       Yes \n0.5758791 0.4241209 \n\nprop.table(table(diabetes_ad$sex))\n\n\n   Female      Male \n0.5596578 0.4403422 \n\nprop.table(table(diabetes_ad$smoker))\n\n\nLess than 100 packs or none          At least 100 packs \n                  0.5568314                   0.4431686 \n\nprop.table(table(diabetes_ad$healthcare))\n\n\n        No        Yes \n0.04894749 0.95105251 \n\nprop.table(table(diabetes_ad$gen_health))\n\n\n Excellent  Very good       Good       Fair       Poor \n0.17856749 0.35116682 0.29819458 0.12444812 0.04762299 \n\n#Summary statistics for BMI\nmean(diabetes_ad$BMI)\n\n[1] 28.38236\n\n\nFrom these results, we can see that the majority of subjects in this data do not have diabetes or prediabetes. Less than half have hypertension or high cholesterol, over half are female, about 44% have smoked at least 100 packs of cigarettes, and over 95% have some form of health insurance. A majority of subjects rated their own health as “Very good” or “good”, with only about 17% saying their health was “fair” or “poor”.\nNext, we’ll look at how the predictors break down by diabetes status:\n\n#Categorical summaries for predictors\nprop.table(table(diabetes_ad$diabetes, diabetes_ad$high_bp),margin=1)\n\n                         \n                                 No       Yes\n  No diabetes             0.6233981 0.3766019\n  Diabetes or prediabetes 0.2473264 0.7526736\n\nprop.table(table(diabetes_ad$diabetes, diabetes_ad$high_chol),margin=1)\n\n                         \n                                 No       Yes\n  No diabetes             0.6157035 0.3842965\n  Diabetes or prediabetes 0.3298817 0.6701183\n\nprop.table(table(diabetes_ad$diabetes, diabetes_ad$sex),margin=1)\n\n                         \n                             Female      Male\n  No diabetes             0.5659357 0.4340643\n  Diabetes or prediabetes 0.5208793 0.4791207\n\nprop.table(table(diabetes_ad$diabetes, diabetes_ad$smoker),margin=1)\n\n                         \n                          Less than 100 packs or none At least 100 packs\n  No diabetes                               0.5689815          0.4310185\n  Diabetes or prediabetes                   0.4817801          0.5182199\n\nprop.table(table(diabetes_ad$diabetes, diabetes_ad$healthcare),margin=1)\n\n                         \n                                  No        Yes\n  No diabetes             0.05035862 0.94964138\n  Diabetes or prediabetes 0.04023086 0.95976914\n\nprop.table(table(diabetes_ad$diabetes, diabetes_ad$gen_health),margin=1)\n\n                         \n                           Excellent  Very good       Good       Fair\n  No diabetes             0.20225434 0.37879121 0.28483424 0.09975542\n  Diabetes or prediabetes 0.03225259 0.18052962 0.38072201 0.27697618\n                         \n                                Poor\n  No diabetes             0.03436478\n  Diabetes or prediabetes 0.12951961\n\n\nThese tables suggest hypertension and high cholesterol might be strong predictors of diabetes, with over two-thirds of those with diabetes reporting hypertension or high cholesterol. Smoking history also appears to differ by diabetes status, with a larger proportion of diabetics reporting having smoked at least 100 packs of cigarettes, but the association isn’t as strong as high blood pressure or cholesterol. Sex and healthcare coverage do not appear to be strongly related to diabetes status. Finally, those with diabetes or prediabetes rate their health lower overall compared to those without these conditions.\nWe’ll consider summary statsitics and a smoothed histogram to compare the distributions of BMI values for those with diabetes/prediabetes vs. those without:\n\ndiabetes_ad |&gt; group_by(diabetes) |&gt; summarize(Mean=mean(BMI),SD=sd(BMI),)\n\n# A tibble: 2 × 3\n  diabetes                 Mean    SD\n  &lt;fct&gt;                   &lt;dbl&gt; &lt;dbl&gt;\n1 No diabetes              27.8  6.29\n2 Diabetes or prediabetes  31.9  7.36\n\n#Smoothed histogram\nggplot(diabetes_ad, aes(x = BMI)) + geom_density(alpha = 0.5, aes(fill = diabetes)) + ylab(\"Density\") + scale_fill_discrete(name = \"\")\n\n\n\n\n\n\n\n\nThe summary statistics indicate that the mean BMI for those with diabetes or prediabetes is about 4 points higher than those without these conditions, and the histogram shows that the entire distribution of BMI values is shifted to the right for the diabetic group. These results suggest that BMI could be a predictor for diabetes."
  },
  {
    "objectID": "EDA.html#link-to-modeling-page",
    "href": "EDA.html#link-to-modeling-page",
    "title": "ST 558 Final Project: Exploratory Data Analysis",
    "section": "Link to modeling page",
    "text": "Link to modeling page\nClick here for the modeling page."
  },
  {
    "objectID": "Modeling.html",
    "href": "Modeling.html",
    "title": "ST 558 Final Project: Modeling",
    "section": "",
    "text": "The purpose of this analysis is to create a predictive model for the incidence of diabetes using data from the 2015 Behavioral Risk Factor Surveillance System (BRFSS) survey conducted by the Centers for Disease Control. The dataset we will use for modeling includes survey responses from 253,680 individuals.\nThe response variable in the dataset, Diabetes_binary, is a 0/1 indicator for the presence of diabetes or prediabetes. There are a number of potential predictors in the dataset, but we will consider only the following health-related variables in the dataset:\n\nBinary factors for hypertension and high cholesterol (yes vs. no)\nReported body mass index (BMI)\nSex (male vs. female)\nA factor for having any kind of health insurance coverage (yes vs. no)\nAn ordinal factor for self-rated general health, ranging from 1 (“Excellent”) to 5 (“Poor”)"
  },
  {
    "objectID": "Modeling.html#introduction",
    "href": "Modeling.html#introduction",
    "title": "ST 558 Final Project: Modeling",
    "section": "",
    "text": "The purpose of this analysis is to create a predictive model for the incidence of diabetes using data from the 2015 Behavioral Risk Factor Surveillance System (BRFSS) survey conducted by the Centers for Disease Control. The dataset we will use for modeling includes survey responses from 253,680 individuals.\nThe response variable in the dataset, Diabetes_binary, is a 0/1 indicator for the presence of diabetes or prediabetes. There are a number of potential predictors in the dataset, but we will consider only the following health-related variables in the dataset:\n\nBinary factors for hypertension and high cholesterol (yes vs. no)\nReported body mass index (BMI)\nSex (male vs. female)\nA factor for having any kind of health insurance coverage (yes vs. no)\nAn ordinal factor for self-rated general health, ranging from 1 (“Excellent”) to 5 (“Poor”)"
  },
  {
    "objectID": "Modeling.html#analysis-data",
    "href": "Modeling.html#analysis-data",
    "title": "ST 558 Final Project: Modeling",
    "section": "Analysis Data",
    "text": "Analysis Data\nAs we did for the exploratory data analysis, we’ll read in the data from the raw CSV file and transform the predictor variables as needed:\n\n#Read in the raw data\ndiabetes_raw &lt;- read_csv(file=\"diabetes_binary_health_indicators_BRFSS2015.csv\",show_col_types=FALSE)\n\n#Create an analysis dataset containing only the relevant variables\nyn_label &lt;- c(\"No\",\"Yes\")\ndiabetes_ad &lt;- diabetes_raw |&gt; select(Diabetes_binary, HighBP ,HighChol, BMI, Smoker, Sex, AnyHealthcare, GenHlth) |&gt;\n               mutate(diabetes = factor(Diabetes_binary, levels=c(0,1), labels=c(\"No diabetes\", \"Diabetes or prediabetes\")))\n\nFor modeling, we’ll do an initial split of the full dataset into training (70%) and test (30%) sets, and then create a 5-fold cross-validation dataset using the training data:\n\n#Create initial split\nset.seed(1434)\ndiab_split &lt;- initial_split(diabetes_ad, prop=0.70)\ndiab_train &lt;- training(diab_split)\ndiab_test &lt;- testing(diab_split)\n\n#Create 5-fold cross-validation sets on the training data\ndiab_5_fold &lt;- vfold_cv(diab_train,5)"
  },
  {
    "objectID": "Modeling.html#modeling",
    "href": "Modeling.html#modeling",
    "title": "ST 558 Final Project: Modeling",
    "section": "Modeling",
    "text": "Modeling\nWe’ll consider both a classification tree model and a random forest model for prediction of diabetes/prediabetes using the variables we have selected.\n\nClassification Tree\nThe classification tree model predicts the outcome-in this case, whether or not the subject has diabetes or prediabetes-by splitting the space of predictor variables into regions on step at a time. To create branches, the modeling process considers splits of each potential predictor and selects the one that produces the best separation of the outcome variable. This process is repeated for each new branch of the tree until the algorithm terminates.\n\ntree_spec &lt;- decision_tree(tree_depth = 8,\n                           cost_complexity = tune()) |&gt;\n             set_engine(\"rpart\") |&gt; set_mode(\"classification\")\n\n#Create the model recipe\ntree_recipe &lt;- recipe(diabetes ~ ., data = diab_train) |&gt;\n               step_mutate(high_bp = factor(HighBP, levels=c(0,1), labels=yn_label),\n                           high_chol = factor(HighChol, levels=c(0,1), labels=yn_label),\n                           sex = factor(Sex, levels=c(0,1), labels=c(\"Female\",\"Male\")),\n                           smoker = factor(Smoker, levels=c(0,1), labels=c(\"Less than 100 packs or none\", \"At least 100 packs\")),\n                           healthcare = factor(AnyHealthcare, levels=c(0,1), labels=yn_label),\n                           gen_health = factor(GenHlth, levels=c(1,2,3,4,5), labels=c(\"Excellent\", \"Very good\", \"Good\", \"Fair\", \"Poor\"))) |&gt;\n               step_normalize(BMI)\nprep(tree_recipe)\n\n\n\n\n── Recipe ──────────────────────────────────────────────────────────────────────\n\n\n\n\n\n── Inputs \n\n\nNumber of variables by role\n\n\noutcome:   1\npredictor: 8\n\n\n\n\n\n── Training information \n\n\nTraining data contained 177576 data points and no incomplete rows.\n\n\n\n\n\n── Operations \n\n\n• Variable mutation for: ~factor(HighBP, levels = c(0, 1), labels = yn_label),\n  ~factor(HighChol, levels = c(0, 1), labels = yn_label), ~factor(Sex, levels =\n  c(0, 1), labels = c(\"Female\", \"Male\")), ~factor(Smoker, levels = c(0, 1),\n  labels = c(\"Less than 100 packs or none\", \"At least 100 packs\")),\n  ~factor(AnyHealthcare, levels = c(0, 1), labels = yn_label), ~factor(GenHlth,\n  levels = c(1, 2, 3, 4, 5), labels = c(\"Excellent\", \"Very good\", \"Good\",\n  \"Fair\", \"Poor\")) | Trained\n\n\n• Centering and scaling for: BMI | Trained\n\n#Create the workflow\ntree_wkf &lt;- workflow() |&gt; add_recipe(tree_recipe) |&gt; add_model(tree_spec)\n\n#Fit the model to the CV folds to select tuning parameters\ntree_grid &lt;- tree_wkf |&gt; tune_grid(resamples=diab_5_fold, \n                                   grid=grid_regular(cost_complexity(),\n                                   levels=5),\n                                   metrics=metric_set(mn_log_loss))\n\n#Collect metrics and choose model with lowest log loss\ntree_best_params &lt;- select_best(tree_grid, metric=\"mn_log_loss\")\ntree_best_params\n\n# A tibble: 1 × 2\n  cost_complexity .config             \n            &lt;dbl&gt; &lt;chr&gt;               \n1    0.0000000001 Preprocessor1_Model1\n\n\n\n\nRandom Forest Model\nThe second model that we’ll consider is a random forest. These models use bootstrap samples from the training data along with a random subset of the predictor variables to create multiple decision trees. Predictions on new data are then made by choosing the classification that is selected most often by the set of trees in the random forest.\nFor our random forest modeling, the number of predictors in the subset chosen for each tree will be chosen by tuning the parameter mtry.\n\nrf_spec &lt;- rand_forest(mtry = tune()) |&gt; set_engine(\"ranger\") |&gt;\nset_mode(\"classification\")\n\n#Create the workflow using the same model recipe as before\nrf_wkf &lt;- workflow() |&gt; add_recipe(tree_recipe) |&gt; add_model(rf_spec)\n\n#Fit the model to the CV folds to select tuning parameter for mtry\nrf_grid &lt;- rf_wkf |&gt; tune_grid(resamples = diab_5_fold,\n                               grid = 7,\n                               metrics = metric_set(mn_log_loss))\n\ni Creating pre-processing data to finalize unknown parameter: mtry\n\n#Collect metrics and choose model with lowest log loss, then display the tuning params\nrf_best_params &lt;- select_best(rf_grid, metric=\"mn_log_loss\")\nrf_best_params\n\n# A tibble: 1 × 2\n   mtry .config             \n  &lt;int&gt; &lt;chr&gt;               \n1    12 Preprocessor1_Model2\n\n\nAmong the grid of values that was searched, the best value of mtry was 3.\n\n\nComparing Models\nTo select the best model, we’ll compare the final classification tree and random forest models by checking their performance on the test portion of the data. The model with the smallest log loss will be the one that we use in the development of the API in the next step of the project.\n\n#Finalize the workflows and run the final models on the full training set\ntree_final_wkf &lt;- tree_wkf |&gt; finalize_workflow(tree_best_params)\ntree_final_fit &lt;- tree_final_wkf |&gt; last_fit(diab_split, metrics=metric_set(mn_log_loss))\nrf_final_wkf &lt;- rf_wkf |&gt; finalize_workflow(rf_best_params)\nrf_final_fit &lt;- rf_final_wkf |&gt; last_fit(diab_split, metrics=metric_set(mn_log_loss))\n\ntree_final_fit |&gt; collect_metrics()\n\n# A tibble: 1 × 4\n  .metric     .estimator .estimate .config             \n  &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               \n1 mn_log_loss binary      2.22e-16 Preprocessor1_Model1\n\nrf_final_fit |&gt; collect_metrics()\n\n# A tibble: 1 × 4\n  .metric     .estimator .estimate .config             \n  &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               \n1 mn_log_loss binary      2.22e-16 Preprocessor1_Model1\n\n\nThe log loss values for the final tree model and final random forest model are 0.333 and 0.323, respectively, so we will use the random forest model in our API."
  }
]